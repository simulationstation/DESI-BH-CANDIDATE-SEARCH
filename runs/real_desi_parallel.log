2026-01-15 18:30:16,740 - __main__ - INFO - Starting full pipeline run in runs/real_run_20260115_183016
2026-01-15 18:30:16,740 - __main__ - INFO - ============================================================
2026-01-15 18:30:16,740 - __main__ - INFO - STAGE 0: Environment Setup and Sanity Checks
2026-01-15 18:30:16,740 - __main__ - INFO - ============================================================
2026-01-15 18:30:17,499 - __main__ - INFO - Git hash: e42cabef7a6c01aa00dfef66e587d8c1cdeb99ba
2026-01-15 18:30:17,499 - __main__ - INFO - Python: 3.12.3 (main, Jan  8 2026, 11:30:50) [GCC 13.3.0]
2026-01-15 18:30:17,499 - __main__ - INFO - Platform: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
2026-01-15 18:30:17,499 - __main__ - INFO - CPU count: 32
2026-01-15 18:30:17,499 - __main__ - INFO - Random seed: 42
2026-01-15 18:30:17,499 - __main__ - INFO - Running quick unit tests...
2026-01-15 18:31:16,246 - __main__ - WARNING - Could not run unit tests: Command '['/usr/bin/python3', '-m', 'pytest', '-q', '--tb=no', 'rare_companions/tests/', '-x']' timed out after 60 seconds
2026-01-15 18:31:16,246 - __main__ - INFO - Found 0 DESI data files
2026-01-15 18:31:16,247 - __main__ - INFO - ============================================================
2026-01-15 18:31:16,247 - __main__ - INFO - STAGE 1: RV Metrics Scan
2026-01-15 18:31:16,247 - __main__ - INFO - ============================================================
2026-01-15 18:31:16,712 - __main__ - INFO - Loading DESI per-epoch RV data...
2026-01-15 18:31:16,712 - rare_companions.ingest.desi - INFO - Loading DESI DR1 RV data...
2026-01-15 18:31:16,712 - rare_companions.ingest.desi - INFO - Loading data/raw/rvpix_exp-main-bright.fits...
2026-01-15 18:31:21,599 - rare_companions.ingest.desi - INFO -   Found 3572976 rows
2026-01-15 18:31:21,954 - rare_companions.ingest.desi - INFO -   After quality filter: 3038422 epochs
2026-01-15 18:34:37,858 - rare_companions.ingest.desi - INFO -   Loaded 3038422 epochs from bright
2026-01-15 18:34:37,858 - rare_companions.ingest.desi - INFO - Loading data/raw/rvpix_exp-main-dark.fits...
2026-01-15 18:34:40,351 - rare_companions.ingest.desi - INFO -   Found 1818406 rows
2026-01-15 18:34:40,491 - rare_companions.ingest.desi - INFO -   After quality filter: 649794 epochs
2026-01-15 18:35:26,852 - rare_companions.ingest.desi - INFO -   Loaded 649794 epochs from dark
2026-01-15 18:35:32,403 - rare_companions.ingest.desi - INFO - Loaded 3688216 total epochs for 2989643 unique targets
2026-01-15 18:35:32,470 - __main__ - INFO - Loaded 2989643 unique targets from DESI
2026-01-15 18:35:32,678 - __main__ - INFO -   Total epochs: 3688216
2026-01-15 18:35:32,678 - __main__ - INFO -   Targets with 3+ epochs: 97823
2026-01-15 18:35:32,678 - __main__ - INFO -   Targets with 5+ epochs: 9937
2026-01-15 18:35:33,558 - __main__ - INFO - Created 97823 RVTimeSeries with 3+ epochs
2026-01-15 18:35:33,558 - __main__ - INFO - Total targets for Stage 1: 97823
2026-01-15 18:35:33,896 - __main__ - INFO - After basic filters: 9397 targets
2026-01-15 18:35:35,504 - __main__ - INFO - Saved RV metrics to runs/real_run_20260115_183016/stage1_rv_metrics.csv
2026-01-15 18:35:36,302 - __main__ - INFO - ============================================================
2026-01-15 18:35:36,302 - __main__ - INFO - STAGE 2: Fast Screening (All Experiments)
2026-01-15 18:35:36,302 - __main__ - INFO - ============================================================
2026-01-15 18:35:36,477 - __main__ - INFO - Running experiment: E1_mass_gap
2026-01-15 18:35:36,479 - rare_companions.experiments.base - INFO - Running experiment: E1_mass_gap
2026-01-15 18:35:36,479 - rare_companions.experiments.base - INFO - Input targets: 9397
2026-01-15 18:35:36,481 - rare_companions.experiments.base - INFO - Processing Stage 1 with 8 parallel workers...
/home/primary/DESI-BH-CANDIDATE-SEARCH/rare_companions/orbit/fast_screen.py:187: RuntimeWarning: invalid value encountered in divide
  chi2_norm = (chi2_grid - chi2_min) / chi2_range
/home/primary/DESI-BH-CANDIDATE-SEARCH/rare_companions/orbit/fast_screen.py:187: RuntimeWarning: invalid value encountered in divide
  chi2_norm = (chi2_grid - chi2_min) / chi2_range
/home/primary/DESI-BH-CANDIDATE-SEARCH/rare_companions/orbit/fast_screen.py:187: RuntimeWarning: invalid value encountered in divide
  chi2_norm = (chi2_grid - chi2_min) / chi2_range
/home/primary/DESI-BH-CANDIDATE-SEARCH/rare_companions/orbit/fast_screen.py:187: RuntimeWarning: invalid value encountered in divide
  chi2_norm = (chi2_grid - chi2_min) / chi2_range
/home/primary/DESI-BH-CANDIDATE-SEARCH/rare_companions/orbit/fast_screen.py:187: RuntimeWarning: invalid value encountered in divide
  chi2_norm = (chi2_grid - chi2_min) / chi2_range
/home/primary/DESI-BH-CANDIDATE-SEARCH/rare_companions/orbit/fast_screen.py:187: RuntimeWarning: invalid value encountered in divide
  chi2_norm = (chi2_grid - chi2_min) / chi2_range
/home/primary/DESI-BH-CANDIDATE-SEARCH/rare_companions/orbit/fast_screen.py:187: RuntimeWarning: invalid value encountered in divide
  chi2_norm = (chi2_grid - chi2_min) / chi2_range
/home/primary/DESI-BH-CANDIDATE-SEARCH/rare_companions/orbit/fast_screen.py:187: RuntimeWarning: invalid value encountered in divide
  chi2_norm = (chi2_grid - chi2_min) / chi2_range
2026-01-15 18:36:33,184 - rare_companions.experiments.base - INFO -   Processed 500/9397 targets...
2026-01-15 18:37:26,723 - rare_companions.experiments.base - INFO -   Processed 1000/9397 targets...
2026-01-15 18:38:24,868 - rare_companions.experiments.base - INFO -   Processed 1500/9397 targets...
2026-01-15 18:39:24,963 - rare_companions.experiments.base - INFO -   Processed 2000/9397 targets...
2026-01-15 18:40:20,920 - rare_companions.experiments.base - INFO -   Processed 2500/9397 targets...
2026-01-15 18:41:16,402 - rare_companions.experiments.base - INFO -   Processed 3000/9397 targets...
2026-01-15 18:42:09,193 - rare_companions.experiments.base - INFO -   Processed 3500/9397 targets...
2026-01-15 18:43:06,052 - rare_companions.experiments.base - INFO -   Processed 4000/9397 targets...
2026-01-15 18:44:02,817 - rare_companions.experiments.base - INFO -   Processed 4500/9397 targets...
2026-01-15 18:45:02,205 - rare_companions.experiments.base - INFO -   Processed 5000/9397 targets...
2026-01-15 18:46:08,915 - rare_companions.experiments.base - INFO -   Processed 5500/9397 targets...
2026-01-15 18:47:12,655 - rare_companions.experiments.base - INFO -   Processed 6000/9397 targets...
2026-01-15 18:48:19,128 - rare_companions.experiments.base - INFO -   Processed 6500/9397 targets...
2026-01-15 18:49:24,729 - rare_companions.experiments.base - INFO -   Processed 7000/9397 targets...
2026-01-15 18:50:29,694 - rare_companions.experiments.base - INFO -   Processed 7500/9397 targets...
2026-01-15 18:51:33,947 - rare_companions.experiments.base - INFO -   Processed 8000/9397 targets...
2026-01-15 18:52:38,121 - rare_companions.experiments.base - INFO -   Processed 8500/9397 targets...
2026-01-15 18:53:42,203 - rare_companions.experiments.base - INFO -   Processed 9000/9397 targets...
